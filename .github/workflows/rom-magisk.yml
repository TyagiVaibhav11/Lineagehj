name: Build and Inject Magisk into LineageOS GSI

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: 📁 Checkout repository
      uses: actions/checkout@v3

    - name: ⬇️ Download LineageOS GSI
      run: |
        wget -O lineage-gsi.7z "https://sourceforge.net/projects/misterztr-gsi/files/LineageOS/Android%2015/LineageOS-22.2-20250509-GAPPS-EROFS-GSI.7z/downlo"

    - name: 📦 Extract GSI
      run: |
        sudo apt-get update
        sudo apt-get install -y p7zip-full unzip
        7z x lineage-gsi.7z -olineage-gsi

    - name: ⬇️ Download Magisk
      run: |
        mkdir -p magisk
        wget -O magisk/magisk.apk "https://github.com/topjohnwu/Magisk/releases/download/v27.0/Magisk-
        
